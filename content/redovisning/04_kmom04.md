---
---
Redovisning kmom04
=========================

Kursmoment 4, vi fick lära oss mer om ramverket men även titta en del på trait och interface. Trait kan jag se en fördel i att det ger möjlighet att dela upp koden mer och man kan enkelt koppla olika klasser till samma trait om de delar en del metoder och egenskaper. Trait är också ett enkelt sätt att säkerställa att en klass uppfyller kraven för ett inteface. Interface ser jag inte så stor nytta av just nu när jag sitter själv i ett projekt och resultatet av koden inte skall kopplas mot någons externa kod. Om det däremot är så att koden skall användas av andra så bli interface väldigt mycket mer användbart och talar enkelt om vad som behöver uppfyllas för att kunna använda den kod jag skrivit, det blir ett verktyg för att kunna koppla ihop min kod med annan kod utan att behöva visa källkoden.

Begreppet controller i kodsammanhang var nytt men kändes ändå ganska hemtamt, även om jag inte kan säga varifrån. Det är inte helt olikt routes men ger en del andra möjligheter i att dela upp koden. Att ha en klass som bara är till för att koppla ihop och hantera resultat från andra klasser känns väldigt naturligt. Controller-klassen blir lite spindeln i nätet, som har koll på och koordinerar alla andra klasser men själv utför ganska lite arbete.

Att skapa intelligensen gick hyfsat, den första ansatsen jag gjorde (bort-kommenterad) markerades som för cykliskt komplex, men jag insåg att den gick att arbeta ihop till en ekvation och en if-sats istället för flera. Intelligensen bygger på sannolikheten att slå en 1 med det antal tärningar man valt. Ett förväntat värde om man vinner räknas ut och multipliceras med sannolikheten för att vinna, vilket ger ett väntevärde. En förväntad kostnad om man förlorar räknas ut i form av nuvarande resultat multiplicerat med sannolikheten att slå en etta. förväntat värde delas med förväntad kostnad för att ge ett beslutsvärde. Baserat på om datorn leder eller ligger efter kommer den sedan att vara mer och mer risktagande. Ju mer datorn ligger efter desto lägre beslutsvärde krävs för att den skall stanna. Beslutsvärdet sänks ju högre det nuvarande resultatet är. Intelligensen skulle kunna byggas på betydligt mer och till exempel ta hänsyn till hur stor sannolikheten var att någon skulle vinna nästa runda eller ta fram en strategi för att vinna inom x antal rundor baserat på förväntat värde osv.

Att integrera hårdare i ramverkets klasser och struktur var inte speciellt krångligt alls, det krävdes några rader kod mer och lite namnbyten på klasser men var på det hela taget enkelt genomfört. Däremot kan jag känna att jag nog borde gå över koden i controllerklassen och se om jag kan organisera den bättre och kanske använda mig av privata metoder för att dela upp de klasser jag har. Jag kan också känna att hela spelet är en aning långsamt och det är något som jag verkligen borde åtgärda, jag skulle tro att det är för många anrop till och från sessionen, men det behöver undersökas mer.

Test inuti ramverket gick bra, det var egentligen bara att bygga på de tester jag hade sedan tidigare, en del ändringar behövde göras och en hel del tester behövde läggas till. Bland klasserna är det en kodrad jag inte lyckats testa, den är inbyggd i en while-sats och bara till för att slå om all tärningar om man får lika när man slår för vem som skall börja. För att kunna testa den raden skulle jag behöva bygga hela klassen annorlunda, vilket får bli ett senare projekt. Jag skulle också behöva skriva tester för controllerklassen, men då jag redan är sen med inlämningen så får det också vänta. Som det är nu når jag bara 58,78% kodtäckning, men jag har 100% eller nästan 100% på alla klasser utom controllerklassen, vilket jag känner är ett bra resultat givet att jag inte skrivit tester för controllerklassen. Jag gör 84 tester och har 453 assertions. Jag kan dock känna att det skulle vara bra att ha lite fler tester med olika benchmarks för intelligensen.

Det här kursmomentet kändes det som att jag lärde mig väldigt mycket, traits, inteface, controller, bygga intelligens, enhetstester. Skall jag nämna något som jag verkligen kommer att ta med mig så är det dock att i klasser bygga lokala variabler som sedan kan användas för att kalla på andra klasser, t.ex. $app = $this->app, det är något som kan spara mycket tid och kodrader i framtiden och som gjorde det oerhört mycket smidigare att flytta kod från router till controller.
